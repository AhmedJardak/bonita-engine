<project name="bpm-services-sp" default="cleantarget">

	<property name="target.dir" value="${basedir}/target"/>
	
	<target name="cleantarget">
		<delete dir="${target.dir}" includes="*.db" />
		<delete dir="${target.dir}/server" />
		<delete dir="${target.dir}/home" />
		
		<copy todir="${target.dir}/home">
			<fileset dir="${basedir}/home" />
		</copy>

		<copy todir="${target.dir}/home/server/licenses" overwrite="true">
			<fileset dir="${user.home}/lic" includes="*.lic" />
		</copy>
		<loadfile srcFile="${basedir}/pom.xml" property="project.version">
			<filterchain>
				<linecontains>
					<contains value="version>"/>
				</linecontains>
				<headfilter lines="1"/>
				<replaceregex pattern=".*&lt;version&gt;(.*)&lt;/version&gt;.*" replace="\1" />
			</filterchain>
		</loadfile>
		<echo file="${basedir}/target/home/server/platform/conf/VERSION" append="false">${project.version}</echo>
	</target>

</project>