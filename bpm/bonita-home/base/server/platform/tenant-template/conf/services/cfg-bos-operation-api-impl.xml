<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

    <bean id="operationsAnalyzer" class="org.bonitasoft.engine.core.operation.impl.OperationsAnalyzer"/>

    <bean id="persistRightOperandResolver" class="org.bonitasoft.engine.core.operation.impl.PersistRightOperandResolver">
        <constructor-arg name="operationsAnalyzer" ref="operationsAnalyzer" />
    </bean>

    <bean id="operationService" class="org.bonitasoft.engine.core.operation.impl.OperationServiceImpl">
        <constructor-arg name="operationExecutorStrategyProvider" ref="operationExecutorStrategyProvider"/>
        <constructor-arg name="leftOperandHandlerProvider" ref="leftOperandHandlerProvider"/>
        <constructor-arg name="expressionResolverService" ref="expressionResolverService"/>
        <constructor-arg name="persistRightOperandResolver" ref="persistRightOperandResolver"/>
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService"/>
    </bean>

    <bean id="operationExecutorStrategyProvider"
          class="org.bonitasoft.engine.core.operation.OperationExecutorStrategyProvider" autowire="constructor"/>

    <bean id="leftOperandHandlerProvider" class="org.bonitasoft.engine.core.operation.LeftOperandHandlerProvider">
        <property name="leftOperandHandlers">
            <list>
                <ref bean="dataLeftOperandHandler"/>
                <ref bean="transientDataLeftOperandHandler"/>
                <ref bean="externalDataLeftOperandHandler"/>
                <ref bean="documentLeftOperandHandler"/>
                <ref bean="documentListLeftOperandHandler"/>
                <ref bean="stringIndexLeftOperandHandler"/>
                <ref bean="businessDataLeftOperandHandler"/>
            </list>
        </property>
    </bean>

    <bean id="assignmentOperationExecutorStrategy"
          class="org.bonitasoft.engine.core.operation.impl.AssignmentOperationExecutorStrategy"/>

    <bean id="dataLeftOperandHandler" class="org.bonitasoft.engine.operation.DataLeftOperandHandler">
        <constructor-arg name="dataInstanceService" ref="dataInstanceService"/>
        <constructor-arg name="parentContainerResolver" ref="parentContainerResolver"/>
    </bean>

    <bean id="transientDataLeftOperandHandler" class="org.bonitasoft.engine.operation.TransientDataLeftOperandHandler">
        <constructor-arg name="transientDataService" ref="transientDataService"/>
        <constructor-arg name="flownodeInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
        <constructor-arg name="bpmInstancesCreator" ref="bpmInstancesCreator"/>
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService"/>
    </bean>

    <bean id="externalDataLeftOperandHandler"
          class="org.bonitasoft.engine.core.operation.impl.ExternalDataLeftOperandHandler"/>

    <bean id="mergeEntityAction" class="com.bonitasoft.engine.operation.MergeEntityAction">
        <constructor-arg name="repository" ref="businessDataRepository"/>

    </bean>

    <bean id="entitiesActionsExecutor" class="com.bonitasoft.engine.operation.EntitiesActionsExecutor"/>

    <bean id="javaMethodOperationExecutorStrategy"
          class="com.bonitasoft.engine.operation.BusinessDataJavaMethodOperationExecutorStrategy">
        <constructor-arg name="businessDataService" ref="businessDataService"/>
        <constructor-arg name="entitiesActionsExecutor" ref="entitiesActionsExecutor"/>
        <constructor-arg name="mergeEntityAction" ref="mergeEntityAction"/>
    </bean>

    <bean id="xpathUpdateQueryOperationExecutorStrategy"
          class="org.bonitasoft.engine.core.operation.impl.XpathUpdateQueryOperationExecutorStrategy"/>

    <bean id="businessDataAssignmentStrategy" class="com.bonitasoft.engine.operation.BusinessDataAssignmentStrategy">
        <constructor-arg name="actionsExecutor" ref="entitiesActionsExecutor"/>
        <constructor-arg name="mergeEntityAction" ref="mergeEntityAction"/>
    </bean>

    <bean id="documentLeftOperandHandler" class="org.bonitasoft.engine.operation.DocumentLeftOperandHandler">
        <constructor-arg name="documentService" ref="documentService"/>
        <constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="sessionAccessor" ref="sessionAccessor"/>
        <constructor-arg name="sessionService" ref="sessionService"/>
    </bean>

    <bean id="documentListLeftOperandHandler" class="org.bonitasoft.engine.operation.DocumentListLeftOperandHandler">
        <constructor-arg name="documentService" ref="documentService"/>
        <constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="sessionAccessor" ref="sessionAccessor"/>
        <constructor-arg name="sessionService" ref="sessionService"/>
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
        <constructor-arg name="processInstanceService" ref="processInstanceService"/>
    </bean>

    <bean id="updateDataRefAction" class="com.bonitasoft.engine.operation.UpdateDataRefAction">
        <constructor-arg name="refBusinessDataService" ref="refBusinessDataService"/>
        <constructor-arg name="flowNodeInstanceService" ref="activityInstanceService"/>
    </bean>

    <bean id="businessDataLeftOperandHandler" class="com.bonitasoft.engine.operation.BusinessDataLeftOperandHandler">
        <constructor-arg name="businessDataRepository" ref="businessDataRepository"/>
        <constructor-arg name="refBusinessDataService" ref="refBusinessDataService"/>
        <constructor-arg name="flowNodeInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="entitiesActionsExecutor" ref="entitiesActionsExecutor"/>
        <constructor-arg name="updateDataRefAction" ref="updateDataRefAction"/>
    </bean>

    <bean id="stringIndexLeftOperandHandler" class="com.bonitasoft.engine.operation.StringIndexLeftOperandHandler">
        <constructor-arg name="processInstanceService" ref="processInstanceService"/>
        <constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
    </bean>

</beans>
