<project name="bonita-engine-SP-home" default="hibernate">

	<property name="bos_home" value="../../../bonita-engine/bpm/bonita-home"/>

	<target name="hibernate">
		<delete dir="${basedir}/target/home" />
		<copy todir="${basedir}/target/home">
			<fileset dir="${bos_home}/common" excludes="**/.svn" />
		</copy>
		<echo>Copy default Hibernate configuration files</echo>
		<copy todir="${basedir}/target/home">
			<fileset dir="${bos_home}/hibernate" excludes="**/.svn" />
		</copy>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/base" excludes="**/.svn" />
		</copy>
		<echo>Override specific Hibernate SP configuration</echo>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/hibernate" excludes="**/.svn" />
		</copy>
		<echo>Copy specific "SP Performance edition" configuration files</echo>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/editions/performance" excludes="**/.svn" />
		</copy>
		<echo>Copy license file from your $HOME/lic folder</echo>
		<copy todir="${basedir}/target/home/server/licenses" failonerror="true">
			<fileset dir="${user.home}/lic" includes="*.lic" />
		</copy>
		<loadfile srcFile="${basedir}/pom.xml" property="project.version">
			<filterchain>
				<linecontains>
					<contains value="version>" />
				</linecontains>
				<headfilter lines="1"/>
				<replaceregex pattern=".*&lt;version&gt;(.*)&lt;/version&gt;.*" replace="\1" />
			</filterchain>
		</loadfile>
		<echo file="${basedir}/target/home/server/platform/conf/VERSION" append="false">${project.version}</echo>
	</target>

	<target name="teamwork">
		<delete dir="${basedir}/target/home" />
		<copy todir="${basedir}/target/home">
			<fileset dir="${bos_home}/common" excludes="**/.svn" />
		</copy>
		<echo>Copy default Hibernate configuration files</echo>
		<copy todir="${basedir}/target/home">
			<fileset dir="${bos_home}/hibernate" excludes="**/.svn" />
		</copy>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/base" excludes="**/.svn" />
		</copy>
		<echo>Override specific Hibernate SP configuration</echo>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/hibernate" excludes="**/.svn" />
		</copy>
		<echo>Copy license file from your $HOME/lic folder</echo>
		<copy todir="${basedir}/target/home/server/licenses" failonerror="true">
			<fileset dir="${user.home}/lic" includes="*.lic" />
		</copy>
		<loadfile srcFile="${basedir}/pom.xml" property="project.version">
			<filterchain>
				<linecontains>
					<contains value="version>" />
				</linecontains>
				<headfilter lines="1"/>
				<replaceregex pattern=".*&lt;version&gt;(.*)&lt;/version&gt;.*" replace="\1" />
			</filterchain>
		</loadfile>
		<echo file="${basedir}/target/home/server/platform/conf/VERSION" append="false">${project.version}</echo>
	</target>

	<target name="cluster">
		<delete dir="${basedir}/target/home" />
		<copy todir="${basedir}/target/home">
			<fileset dir="${bos_home}/common" excludes="**/.svn" />
		</copy>
		<echo>Copy default Hibernate configuration files</echo>
		<copy todir="${basedir}/target/home">
			<fileset dir="${bos_home}/hibernate" excludes="**/.svn" />
		</copy>
		<copy todir="${basedir}/target/home">
			<fileset dir="${basedir}/base" excludes="**/.svn" />
		</copy>
		<echo>Override specific Hibernate SP configuration</echo>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/hibernate" excludes="**/.svn" />
		</copy>
		<echo>Copy specific "SP Performance edition" configuration files</echo>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/editions/performance" excludes="**/.svn" />
		</copy>
		<echo>Copy specific "SP Performance edition" cluster configuration files</echo>
		<copy todir="${basedir}/target/home" overwrite="true">
			<fileset dir="${basedir}/editions/performance-cluster" excludes="**/.svn" />
		</copy>
		<echo>Copy license file from your $HOME/lic folder</echo>
		<copy todir="${basedir}/target/home/server/licenses" failonerror="true">
			<fileset dir="${user.home}/lic" includes="*.lic" />
		</copy>
		<loadfile srcFile="${basedir}/pom.xml" property="project.version">
			<filterchain>
				<linecontains>
					<contains value="version>"/>
				</linecontains>
				<replaceregex pattern=".*&lt;version&gt;(.*)&lt;/version&gt;.*" replace="\1" />
			</filterchain>
		</loadfile>
		<echo file="${basedir}/target/home/server/platform/conf/VERSION" append="false">${project.version}</echo>
	</target>

</project>
