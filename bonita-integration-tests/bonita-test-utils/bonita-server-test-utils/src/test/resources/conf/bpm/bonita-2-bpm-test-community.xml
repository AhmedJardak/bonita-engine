<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

	<bean id="hbm-bos-actor-mapping" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/actor/mapping/model/impl/hibernate/actor.hbm.xml</value>
				<value>org/bonitasoft/engine/actor/mapping/model/impl/hibernate/actor.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.actor.mapping.model.SActor" value="actor" />
				<entry key="org.bonitasoft.engine.actor.mapping.model.SActorMember" value="actormember" />
			</map>
		</property>
	</bean>


	<bean id="actorMappingService" class="org.bonitasoft.engine.actor.mapping.impl.ActorMappingServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
		<constructor-arg name="identityService" ref="identityService" />
    </bean>

    <bean id="businessDataRepository" class="org.bonitasoft.engine.business.data.impl.JPABusinessDataRepositoryImpl">
        <constructor-arg name="transactionService" ref="transactionService" />
        <constructor-arg name="businessDataModelRepository" ref="businessDataModelRepository" />
        <constructor-arg>
            <map>
                <entry key="hibernate.dialect" value="org.hibernate.dialect.H2Dialect" />
                <entry key="hibernate.connection.datasource" value="java:comp/env/BusinessDataDS" />
                <entry key="hibernate.show_sql" value="false" />
                <entry key="hibernate.format_sql" value="false" />
                <entry key="hibernate.transaction.jta.platform" value="org.bonitasoft.engine.persistence.JNDIBitronixJtaPlatform" />
                <entry key="hibernate.validator.autoregister_listeners" value="false" />
                <entry key="hibernate.validator.apply_to_ddl" value="false" />
                <entry key="javax.persistence.validation.mode" value="NONE" />
            </map>
        </constructor-arg>
    </bean>

    <bean id="businessDataModelRepository" class="org.bonitasoft.engine.business.data.impl.BusinessDataModelRepositoryImpl">
        <constructor-arg name="dependencyService" ref="dependencyService" />
        <constructor-arg name="schemaManager" ref="schemaManager" />
        <constructor-arg name="compilationPath">
            <value>${bonita.home}/server/platform/data-management/compilation-dependencies
            </value>
        </constructor-arg>
        <constructor-arg name="clientStoragePath">
            <value>${bonita.home}/server/platform/data-management/client
            </value>
        </constructor-arg>
    </bean>

    <bean id="schemaManager" class="org.bonitasoft.engine.business.data.impl.SchemaManager">
        <constructor-arg name="loggerService" ref="tenantTechnicalLoggerService" />
        <constructor-arg name="configuration">
            <map>
                <entry key="hibernate.dialect" value="org.hibernate.dialect.H2Dialect" />
                <entry key="hibernate.connection.datasource" value="java:comp/env/NotManagedBizDataDS" />
                <entry key="hibernate.show_sql" value="true" />
                <entry key="hibernate.format_sql" value="true" />
                <entry key="hibernate.transaction.jta.platform" value="org.bonitasoft.engine.persistence.JNDIBitronixJtaPlatform" />
                <entry key="hibernate.validator.autoregister_listeners" value="false" />
                <entry key="hibernate.validator.apply_to_ddl" value="false" />
                <entry key="javax.persistence.validation.mode" value="NONE" />
            </map>
        </constructor-arg>
    </bean>

    <bean id="jsonBusinessDataSerializer" class="org.bonitasoft.engine.business.data.impl.JsonBusinessDataSerializerImpl"/>

    <bean id="typeConverterUtil" class="org.bonitasoft.engine.commons.TypeConverterUtil">
        <constructor-arg name="datePatterns" type="java.lang.String[]">
            <list>
                <value>yyyy-MM-dd</value>
                <value>HH:mm:ss</value>
                <value>yyyy-MM-dd HH:mm:ss</value>
                <value>yyyy-MM-dd'T'HH:mm:ss</value>
                <value>yyyy-MM-dd'T'HH:mm:ss.SSS</value>
            </list>
        </constructor-arg>
    </bean>

    <bean id="businessDataService" class="org.bonitasoft.engine.business.data.impl.BusinessDataServiceImpl">
        <constructor-arg name="businessDataRepository" ref="businessDataRepository" />
        <constructor-arg name="jsonBusinessDataSerializer" ref="jsonBusinessDataSerializer" />
        <constructor-arg name="businessDataModelRepository" ref="businessDataModelRepository" />
        <constructor-arg name="typeConverterUtil" ref="typeConverterUtil" />
    </bean>

	<bean id="categoryService" class="org.bonitasoft.engine.core.category.impl.CategoryServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="sessionService" ref="sessionService" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
    </bean>



	<bean id="hbm-bos-category-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/core/category/model/impl/hibernate/category.hbm.xml</value>
				<value>org/bonitasoft/engine/core/category/model/impl/hibernate/category.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.core.category.model.SCategory" value="category" />
				<entry key="org.bonitasoft.engine.core.category.model.SProcessCategoryMapping" value="categorymapping" />
			</map>
		</property>
	</bean>

	<bean class="org.bonitasoft.engine.command.DefaultCommandProvider" />


    <bean id="connectorService" class="org.bonitasoft.engine.core.connector.impl.ConnectorServiceImpl">
        <constructor-arg name="cacheService" ref="cacheService" />
        <constructor-arg name="connectorExecutor" ref="connectorExecutor" />
        <constructor-arg name="parserFactory" ref="parserFactory" />
        <constructor-arg name="sessionAccessor" ref="sessionAccessor" />
        <constructor-arg name="expressionResolverService" ref="expressionResolverService" />
        <constructor-arg name="operationService" ref="operationService" />
        <constructor-arg name="dependencyService" ref="dependencyService" />
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
        <constructor-arg name="timeTracker" ref="timeTracker" />
    </bean>

	<bean id="connectorInstanceService" class="org.bonitasoft.engine.core.connector.impl.ConnectorInstanceServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
        <constructor-arg name="archiveService" ref="archiveService" />
    </bean>

    <bean id="documentService" class="org.bonitasoft.engine.core.document.api.impl.DocumentServiceImpl">
        <constructor-arg name="recorder" ref="tenantRecorderSync"/>
        <constructor-arg name="persistenceService" ref="persistenceService"/>
        <constructor-arg name="urlProvider" ref="documentURLProvider"/>
        <constructor-arg name="eventService" ref="eventService"/>
        <constructor-arg name="archiveService" ref="archiveService"/>
    </bean>

    <bean name="documentURLProvider" class="org.bonitasoft.engine.core.document.api.impl.SDocumentDownloadURLProviderImpl">
        <constructor-arg name="servletUrl" value="${document.servlet.url}"/>
    </bean>



    <bean id="hbm-bonita-document-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
        <property name="resources">
            <set>
                <value>org/bonitasoft/engine/core/document/model/impl/hibernate/document.hbm.xml</value>
                <value>org/bonitasoft/engine/core/document/model/impl/hibernate/document.queries.hbm.xml</value>
                <value>org/bonitasoft/engine/core/document/model/impl/hibernate/archive.document.hbm.xml</value>
                <value>org/bonitasoft/engine/core/document/model/impl/hibernate/archive.document.queries.hbm.xml</value>
            </set>
        </property>
        <property name="classAliasMappings">
            <map>
                <entry key="org.bonitasoft.engine.core.document.model.SDocument" value="doc"/>
                <entry key="org.bonitasoft.engine.core.document.model.SLightDocument" value="doc"/>
                <entry key="org.bonitasoft.engine.core.document.model.SDocumentMapping" value="docmapping"/>
                <entry key="org.bonitasoft.engine.core.document.model.SMappedDocument" value="mappeddoc"/>
                <entry key="org.bonitasoft.engine.core.document.model.archive.SADocumentMapping" value="docmapping"/>
                <entry key="org.bonitasoft.engine.core.document.model.archive.SAMappedDocument" value="mappeddoc"/>
            </map>
        </property>
    </bean>



    <!-- depends on transientDataExpressionExecutorStrategy because if this bean is loaded before it cause a circular dependency -->
    <bean id="expressionResolverService"  class="org.bonitasoft.engine.core.expression.control.api.impl.ExpressionResolverServiceImpl" depends-on="transientDataExpressionExecutorStrategy">
        <constructor-arg name="expressionService" ref="expressionService"/>
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
        <constructor-arg name="classLoaderService" ref="classLoaderService"/>
        <constructor-arg name="timeTracker" ref="timeTracker"/>
    </bean>



	<bean id="loginService" class="org.bonitasoft.engine.core.login.SecuredLoginServiceImpl">
		<constructor-arg ref="authenticationService" />
		<constructor-arg ref="sessionService" />
		<constructor-arg ref="sessionAccessor" />
		<constructor-arg ref="identityService" />
	</bean>


 	<bean id="operationService" class="org.bonitasoft.engine.core.operation.impl.OperationServiceImpl">
 		<constructor-arg name="operationExecutorStrategyProvider" ref="operationExecutorStrategyProvider" />
 		<constructor-arg name="leftOperandHandlerProvider" ref="leftOperandHandlerProvider" />
 		<constructor-arg name="expressionResolverService" ref="expressionResolverService" />
 		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
 	</bean>

	<bean id="operationExecutorStrategyProvider" class="org.bonitasoft.engine.core.operation.OperationExecutorStrategyProvider" autowire="constructor" />

	<bean id="leftOperandHandlerProvider" class="org.bonitasoft.engine.core.operation.LeftOperandHandlerProvider">
		<property name="leftOperandHandlers">
			<list>
				<ref bean="dataLeftOperandHandler"/>
				<ref bean="externalDataLeftOperandHandler"/>
				<ref bean="documentLeftOperandHandler"/>
				<ref bean="documentListLeftOperandHandler"/>
				<ref bean="businessDataLeftOperandHandler" />
				<ref bean="transientDataLeftOperandHandler"/>
			</list>
		</property>
	</bean>

	<bean id="transientDataLeftOperandHandler" class="org.bonitasoft.engine.operation.TransientDataLeftOperandHandler">
		<constructor-arg name="transientDataService" ref="transientDataService"/>
		<constructor-arg name="flownodeInstanceService" ref="activityInstanceService"/>
		<constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
		<constructor-arg name="bpmInstancesCreator" ref="bpmInstancesCreator"/>
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService"/>
	</bean>
	
	<bean id="businessDataLeftOperandHandler" class="org.bonitasoft.engine.operation.BusinessDataLeftOperandHandler">
		<constructor-arg name="businessDataRepository" ref="businessDataRepository"/>
		<constructor-arg name="refBusinessDataService" ref="refBusinessDataService"/>
		<constructor-arg name="flowNodeInstanceService" ref="activityInstanceService"/>
	</bean>

	<bean id="documentLeftOperandHandler" class="org.bonitasoft.engine.operation.DocumentLeftOperandHandler">
		<constructor-arg name="documentService" ref="documentService"/>
		<constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
		<constructor-arg name="sessionAccessor" ref="sessionAccessor"/>
		<constructor-arg name="sessionService" ref="sessionService"/>
	</bean>

	<bean id="documentListLeftOperandHandler" class="org.bonitasoft.engine.operation.DocumentListLeftOperandHandler">
		<constructor-arg name="documentService" ref="documentService"/>
		<constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
		<constructor-arg name="sessionAccessor" ref="sessionAccessor"/>
		<constructor-arg name="sessionService" ref="sessionService"/>
		<constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
		<constructor-arg name="processInstanceService" ref="processInstanceService"/>
	</bean>

	<bean id="assignmentOperationExecutorStrategy" class="org.bonitasoft.engine.core.operation.impl.AssignmentOperationExecutorStrategy" />

	<bean id="dataLeftOperandHandler" class="org.bonitasoft.engine.operation.DataLeftOperandHandler">
		<constructor-arg name="dataInstanceService" ref="dataInstanceService" />
		<constructor-arg name="parentContainerResolver" ref="parentContainerResolver"/>
	</bean>
	
	<bean id="externalDataLeftOperandHandler" class="org.bonitasoft.engine.core.operation.impl.ExternalDataLeftOperandHandler"/>


	<bean id="javaMethodOperationExecutorStrategy"
		  class="org.bonitasoft.engine.operation.BusinessDataJavaMethodOperationExecutorStrategy">
		<constructor-arg name="businessDataService" ref="businessDataService"/>
	</bean>

	<bean id="xpathUpdateQueryOperationExecutorStrategy" class="org.bonitasoft.engine.core.operation.impl.XpathUpdateQueryOperationExecutorStrategy" />

	<bean id="platformLoginService" class="org.bonitasoft.engine.core.platform.login.impl.PlatformLoginServiceImpl">
		<constructor-arg name="platformAuthenticationService" ref="platformAuthenticationService" />
		<constructor-arg name="platformSessionService" ref="platformSessionService" />
	</bean>


    <bean id="commentService" class="org.bonitasoft.engine.core.process.comment.api.impl.SCommentServiceImpl">
        <constructor-arg name="recorder" ref="tenantRecorderSync" />
        <constructor-arg name="sessionService" ref="sessionService" />
        <constructor-arg name="sessionAccessor" ref="sessionAccessor" />
        <constructor-arg name="persistenceService" ref="persistenceService" />
        <constructor-arg name="archiveService" ref="archiveService" />
        <constructor-arg name="systemCommentType">
            <map>
                <entry key="STATE_CHANGE" value="true" />
            </map>
        </constructor-arg>
        <constructor-arg name="eventService" ref="eventService" />
    </bean>

	<bean id="hbm-bos-process-comment-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/core/process/comment/model/impl/hibernate/comment.hbm.xml</value>
				<value>org/bonitasoft/engine/core/process/comment/model/impl/hibernate/comment.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.core.process.comment.model.SComment" value="comment" />
				<entry key="org.bonitasoft.engine.core.process.comment.model.SHumanComment" value="comment" />
				<entry key="org.bonitasoft.engine.core.process.comment.model.SSystemComment" value="comment" />
			</map>
		</property>
	</bean>
	
	<bean id="hbm-bos-process-comment-model-arch" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/core/process/comment/model/impl/hibernate/archive.comment.hbm.xml</value>
				<value>org/bonitasoft/engine/core/process/comment/model/impl/hibernate/archive.comment.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.core.process.comment.model.archive.SAComment" value="saComment" />
			</map>
		</property>
	</bean>	


	<bean id="processDefinitionManager" class="org.bonitasoft.engine.core.process.definition.ProcessDefinitionServiceImpl">
		<constructor-arg name="cacheService" ref="cacheService" />
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync"/>
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="sessionService" ref="sessionService" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="parserFactory" ref="parserFactory" />
		<constructor-arg name="xmlWriter" ref="xmlWriter" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
        <constructor-arg name="dependencyService" ref="dependencyService" />
    </bean>


	<bean id="hbm-bonita-process-definition-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/core/process/definition/model/impl/hibernate/process.definition.hbm.xml</value>
				<value>org/bonitasoft/engine/core/process/definition/model/impl/hibernate/process.definition.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.core.process.definition.model.SProcessDefinitionDeployInfo" value="process_definition" />
				<entry key="org.bonitasoft.engine.actor.mapping.model.SActor" value="actor" />
				<entry key="org.bonitasoft.engine.actor.mapping.model.SActorMember" value="actormember" />
				<entry key="org.bonitasoft.engine.identity.model.SUser" value="user" />
			</map>
		</property>
	</bean>


	<bean id="activityInstanceService" class="org.bonitasoft.engine.core.process.instance.impl.ActivityInstanceServiceImpl">
		<constructor-arg name="recorder" ref="tenantRecorderSync"/>
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="archiveService" ref="archiveService" />
		<constructor-arg name="dataInstanceService" ref="dataInstanceService" />
        <constructor-arg name="connectorInstanceService" ref="connectorInstanceService" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>

	<bean id="processInstanceService" class="org.bonitasoft.engine.core.process.instance.impl.ProcessInstanceServiceImpl">
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="persistenceRead" ref="persistenceService" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="activityService" ref="activityInstanceService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="bpmEventInstanceService" ref="eventInstanceService" />
		<constructor-arg name="dataInstanceService" ref="dataInstanceService" />
		<constructor-arg name="archiveService" ref="archiveService" />
        <constructor-arg name="transitionService" ref="transitionService" />
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager" />
        <constructor-arg name="connectorInstanceService" ref="connectorInstanceService" />
        <constructor-arg name="classLoaderService" ref="classLoaderService" />
        <constructor-arg name="documentService" ref="documentService" />
        <constructor-arg name="commentService" ref="commentService" />
	</bean>
	
	<bean id="gatewayInstanceService" class="org.bonitasoft.engine.core.process.instance.impl.GatewayInstanceServiceImpl">
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="persistenceRead" ref="persistenceService" />
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="flowNodeInstanceService" ref="activityInstanceService" />
    </bean>

	<bean id="transitionService" class="org.bonitasoft.engine.core.process.instance.impl.TransitionServiceImpl">
		<constructor-arg name="persistenceRead" ref="persistenceService" />
		<constructor-arg name="archiveService" ref="archiveService" />
    </bean>
	
	<bean id="eventInstanceService" class="org.bonitasoft.engine.core.process.instance.event.impl.EventInstanceServiceImpl">
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="archiveService" ref="archiveService" />
    </bean>
	
    <bean id="refBusinessDataService" class="org.bonitasoft.engine.core.process.instance.impl.RefBusinessDataServiceImpl">
        <constructor-arg name="recorder" ref="tenantRecorderSync" />
        <constructor-arg name="persistenceRead" ref="persistenceService" />
        <constructor-arg name="eventService" ref="eventService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
    </bean>


	<bean id="hbm-bonita-process-instance-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/core/process/instance/model/impl/hibernate/process.instance.hbm.xml</value>
				<value>org/bonitasoft/engine/core/process/instance/model/impl/hibernate/process.instance.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.core.process.instance.model.SProcessInstance" value="p" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SActivityInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SFlowNodeInstance" value="f" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SGatewayInstance" value="g" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SConnectorInstance" value="c" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SConnectorInstanceWithFailureInfo" value="cfi" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.SStartEventInstance" value="e" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.SBoundaryEventInstance" value="e" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.SIntermediateCatchEventInstance" value="e" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.SIntermediateThrowEventInstance" value="e" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.SEndEventInstance" value="e" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.SEventInstance" value="e" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.SCatchEventInstance" value="e" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.trigger.STimerEventTriggerInstance" value="t" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.trigger.SEventTriggerInstance" value="t" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.trigger.SThrowMessageEventTriggerInstance" value="t" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.trigger.SThrowSignalEventTriggerInstance" value="t" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.trigger.SThrowErrorEventTriggerInstance" value="t" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.handling.SWaitingEvent" value="s" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.handling.SWaitingMessageEvent" value="s" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.handling.SWaitingSignalEvent" value="s" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.handling.SWaitingErrorEvent" value="s" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.event.handling.SMessageInstance" value="m" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SPendingActivityMapping" value="mapping" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SActivityInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SAutomaticTaskInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SReceiveTaskInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SCallActivityInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SSubProcessActivityInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SUserTaskInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SHumanTaskInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SLoopActivityInstance" value="la" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SMultiInstanceActivityInstance" value="a" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.SUserTaskInstance" value="a" />
			</map>
		</property>
	</bean>

	<!-- Archived objects -->
	<bean  id="hbm-bonita-process-instance-model-arch" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/core/process/instance/model/impl/hibernate/archived.process.instance.hbm.xml</value>
				<value>org/bonitasoft/engine/core/process/instance/model/impl/hibernate/archived.process.instance.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAProcessInstance" value="ap" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAFlowNodeInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAActivityInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAAutomaticTaskInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAReceiveTaskInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SASendTaskInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SACallActivityInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SASubProcessActivityInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAUserTaskInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAHumanTaskInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SALoopActivityInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAGatewayInstance" value="aa" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SATransitionInstance" value="at" />
				<entry key="org.bonitasoft.engine.core.process.instance.model.archive.SAConnectorInstance" value="ac" />
			</map>
		</property>
	</bean>

	<bean id="hbm-bos-supervisor-mapping" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/supervisor/mapping/model/impl/hibernate/supervisor.hbm.xml</value>
				<value>org/bonitasoft/engine/supervisor/mapping/model/impl/hibernate/supervisor.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.supervisor.mapping.model.SProcessSupervisor" value="processsupervisor" />
			</map>
		</property>
	</bean>


	<bean id="supervisorMappingService" class="org.bonitasoft.engine.supervisor.mapping.impl.SupervisorMappingServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
    </bean>

	<bean id="tenantConfiguration" class="org.bonitasoft.engine.api.impl.TenantConfiguration" autowire="byType">
		<property name="eventHandlingJobCron" value="${org.bonitasoft.engine.cron}" />
		<property name="cleanInvalidSessionsJobCron" value="${org.bonitasoft.engine.clean.invalid.sessions.cron}" />
		<property name="jobListeners">
			<list>
				<ref bean="timerEventTriggerJobListener" />
			</list>
		</property>
	</bean>
	
	<bean id="timerEventTriggerJobListener" class="org.bonitasoft.engine.jobs.TimerEventTriggerJobListener">
		<constructor-arg name="eventInstanceService" ref="eventInstanceService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="tenantId" value="1" />
	</bean>


	<bean id="userFilterService" class="org.bonitasoft.engine.userfilter.UserFilterServiceDecorator">
		<constructor-arg name="userFilterService" ref="userFilterServiceSub" />
	</bean>
	
	<bean id="userFilterServiceSub" class="org.bonitasoft.engine.core.filter.impl.UserFilterServiceImpl">
		<constructor-arg name="connectorExecutor" ref="connectorExecutor" />
		<constructor-arg name="cacheService" ref="cacheService" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="expressionResolverService" ref="expressionResolverService" />
		<constructor-arg name="parserFactory" ref="parserFactory" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>





    <bean id="syncQueriableLoggerService" class="org.bonitasoft.engine.services.impl.SyncQueriableLoggerServiceImpl">
        <constructor-arg name="persistenceService" ref="persistenceService"/>
        <constructor-arg name="loggerStrategy" ref="queriableLoggerStrategy"/>
        <constructor-arg name="sessionProvider" ref="queriableLogSessionProvider"/>
        <constructor-arg name="logger" ref="platformTechnicalLoggerService"/>
        <constructor-arg name="platformService" ref="platformService"/>
    </bean>

    <bean id="xmlValidatorFactory" class="org.bonitasoft.engine.xml.SAXValidatorFactory"/>

    <bean id="xmlWriter" class="org.bonitasoft.engine.xml.DOMWriter">
        <constructor-arg name="validator" ref="xmlValidator"/>
    </bean>

    <bean id="parserFactory" class="org.bonitasoft.engine.xml.parse.SAXParserFactory">
        <constructor-arg name="validatorFactory" ref="xmlValidatorFactory"/>
        <constructor-arg name="logger" ref="platformTechnicalLoggerService"/>
    </bean>



    <bean id="transactionExecutor" class="org.bonitasoft.engine.execution.TransactionExecutorImpl">
        <constructor-arg name="transactionService" ref="transactionService"/>
    </bean>

    <bean id="searchEntitiesDescriptor" class="org.bonitasoft.engine.search.descriptor.SearchEntitiesDescriptor">
    </bean>

    <bean id="flowNodeExecutor" class="org.bonitasoft.engine.execution.FlowNodeExecutorImpl">
        <constructor-arg name="flowNodeStateManager" ref="flowNodeStateManager"/>
        <constructor-arg name="activityInstanceManager" ref="activityInstanceService"/>
        <constructor-arg name="operationService" ref="operationService"/>
        <constructor-arg name="archiveService" ref="archiveService"/>
        <constructor-arg name="dataInstanceService" ref="dataInstanceService"/>
        <constructor-arg name="containerRegistry" ref="containerRegistry"/>
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
        <constructor-arg name="commentService" ref="commentService"/>
        <constructor-arg name="processInstanceService" ref="processInstanceService"/>
        <constructor-arg name="connectorInstanceService" ref="connectorInstanceService"/>
        <constructor-arg name="classLoaderService" ref="classLoaderService"/>
        <constructor-arg name="workService" ref="workService"/>
    </bean>

    <bean id="containerRegistry" class="org.bonitasoft.engine.execution.ContainerRegistry">
        <constructor-arg name="workService" ref="workService"/>
    </bean>

    <bean id="bpmInstancesCreator" class="org.bonitasoft.engine.bpm.model.impl.BPMInstancesCreator">
        <constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="actorMappingService" ref="actorMappingService"/>
        <constructor-arg name="gatewayInstanceService" ref="gatewayInstanceService"/>
        <constructor-arg name="eventInstanceService" ref="eventInstanceService"/>
        <constructor-arg name="connectorInstanceService" ref="connectorInstanceService"/>
        <constructor-arg name="expressionResolverService" ref="expressionResolverService"/>
        <constructor-arg name="dataInstanceService" ref="dataInstanceService"/>
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService"/>
        <constructor-arg name="transientDataService" ref="transientDataService"/>
        <constructor-arg name="archiveService" ref="archiveService"/>
        <constructor-arg name="parentContainerResolver" ref="parentContainerResolver"/>
        <constructor-arg name="refBusinessDataService" ref="refBusinessDataService"/>
    </bean>

    <bean id="flowNodeStateManager" class="org.bonitasoft.engine.execution.FlowNodeStateManagerImpl">
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
        <constructor-arg name="processInstanceService" ref="processInstanceService"/>
        <constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="connectorInstanceService" ref="connectorInstanceService"/>
        <constructor-arg name="classLoaderService" ref="classLoaderService"/>
        <constructor-arg name="expressionResolverService" ref="expressionResolverService"/>
        <constructor-arg name="schedulerService" ref="scheduler"/>
        <constructor-arg name="dataInstanceService" ref="dataInstanceService"/>
        <constructor-arg name="eventInstanceService" ref="eventInstanceService"/>
        <constructor-arg name="operationService" ref="operationService"/>
        <constructor-arg name="bpmInstancesCreator" ref="bpmInstancesCreator"/>
        <constructor-arg name="containerRegistry" ref="containerRegistry"/>
        <constructor-arg name="archiveService" ref="archiveService"/>
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService"/>
        <constructor-arg name="documentService" ref="documentService"/>
        <constructor-arg name="commentService" ref="commentService"/>
        <constructor-arg name="eventsHandler" ref="eventsHandler"/>
        <constructor-arg name="userFilterService" ref="userFilterService"/>
        <constructor-arg name="actorMappingService" ref="actorMappingService"/>
        <constructor-arg name="workService" ref="workService"/>
        <constructor-arg name="identityService" ref="identityService"/>
        <constructor-arg name="parentContainerResolver" ref="parentContainerResolver"/>
        <constructor-arg name="refBusinessDataService" ref="refBusinessDataService"/>
    </bean>

    <bean id="eventsHandler" class="org.bonitasoft.engine.execution.event.EventsHandler">
        <constructor-arg name="schedulerService" ref="scheduler"/>
        <constructor-arg name="expressionResolverService" ref="expressionResolverService"/>
        <constructor-arg name="eventInstanceService" ref="eventInstanceService"/>
        <constructor-arg name="bpmInstancesCreator" ref="bpmInstancesCreator"/>
        <constructor-arg name="dataInstanceService" ref="dataInstanceService"/>
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
        <constructor-arg name="containerRegistry" ref="containerRegistry"/>
        <constructor-arg name="processInstanceService" ref="processInstanceService"/>
        <constructor-arg name="flowNodeInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService"/>
    </bean>

    <bean id="transitionConditionEvaluator" class="org.bonitasoft.engine.execution.transition.TransitionConditionEvaluator">
        <constructor-arg name="resolverService" ref="expressionResolverService" />
    </bean>

    <bean id="defaultTransitionGetter" class="org.bonitasoft.engine.execution.transition.DefaultTransitionGetter"/>
    <bean id="implicitGatewayTransitionEvaluator" class="org.bonitasoft.engine.execution.transition.ImplicitGatewayTransitionEvaluator">
        <constructor-arg name="conditionEvaluator" ref="transitionConditionEvaluator"/>
        <constructor-arg name="defaultTransitionGetter" ref="defaultTransitionGetter"/>
    </bean>

    <bean id="inclusiveGatewayTransitionEvaluationStrategy" class="org.bonitasoft.engine.execution.transition.InclusiveGatewayTransitionEvaluationStrategy"/>
    <bean id="exclusiveGatewayTransitionEvaluationStrategy" class="org.bonitasoft.engine.execution.transition.ExclusiveGatewayTransitionEvaluationStrategy"/>

    <bean id="inclusiveTransitionEvaluator" class="org.bonitasoft.engine.execution.transition.InclusiveExclusiveTransitionEvaluator">
        <constructor-arg name="strategy" ref="inclusiveGatewayTransitionEvaluationStrategy"/>
        <constructor-arg name="evaluator" ref="transitionConditionEvaluator"/>
        <constructor-arg name="defaultTransitionGetter" ref="defaultTransitionGetter"/>

    </bean>

    <bean id="exclusiveTransitionEvaluator" class="org.bonitasoft.engine.execution.transition.InclusiveExclusiveTransitionEvaluator">
        <constructor-arg name="strategy" ref="exclusiveGatewayTransitionEvaluationStrategy"/>
        <constructor-arg name="evaluator" ref="transitionConditionEvaluator"/>
        <constructor-arg name="defaultTransitionGetter" ref="defaultTransitionGetter"/>
    </bean>

    <bean id="parallelGatewayTransitionEvaluator" class="org.bonitasoft.engine.execution.transition.ParallelGatewayTransitionEvaluator"/>

    <bean id="transitionEvaluator" class="org.bonitasoft.engine.execution.TransitionEvaluator">
        <constructor-arg name="implicitGatewayTransitionEvaluator" ref="implicitGatewayTransitionEvaluator"/>
        <constructor-arg name="parallelGatewayTransitionEvaluator" ref="parallelGatewayTransitionEvaluator"/>
        <constructor-arg name="inclusiveTransitionEvaluator" ref="inclusiveTransitionEvaluator"/>
        <constructor-arg name="exclusiveTransitionEvaluator" ref="exclusiveTransitionEvaluator"/>
    </bean>

    <bean id="processExecutor" class="org.bonitasoft.engine.execution.ProcessExecutorImpl">
        <constructor-arg name="activityInstanceService" ref="activityInstanceService"/>
        <constructor-arg name="processInstanceService" ref="processInstanceService"/>
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService"/>
        <constructor-arg name="flowNodeExecutor" ref="flowNodeExecutor"/>
        <constructor-arg name="workService" ref="workService"/>
        <constructor-arg name="processDefinitionService" ref="processDefinitionManager"/>
        <constructor-arg name="gatewayInstanceService" ref="gatewayInstanceService"/>
        <constructor-arg name="transitionService" ref="transitionService"/>
        <constructor-arg name="eventInstanceService" ref="eventInstanceService"/>
        <constructor-arg name="connectorService" ref="connectorService"/>
        <constructor-arg name="connectorInstanceService" ref="connectorInstanceService"/>
        <constructor-arg name="classLoaderService" ref="classLoaderService"/>
        <constructor-arg name="operationService" ref="operationService"/>
        <constructor-arg name="expressionResolverService" ref="expressionResolverService"/>
        <constructor-arg name="eventService" ref="eventService"/>
        <constructor-arg name="handlers">
            <map>
                <entry key="PROCESSINSTANCE_STATE_UPDATED">
                    <bean class="org.bonitasoft.engine.execution.handler.ArchiveProcessInstancesHandler">
						<constructor-arg name="tenantId" value="0" />
					</bean>
				</entry>
			</map>
		</constructor-arg>
		<constructor-arg name="documentService" ref="documentService"/>
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="containerRegistry" ref="containerRegistry" />
		<constructor-arg name="bpmInstancesCreator" ref="bpmInstancesCreator" />
		<constructor-arg name="eventsHandler" ref="eventsHandler" />
		<constructor-arg name="flowNodeStateManager" ref="flowNodeStateManager" />
        <constructor-arg name="transitionEvaluator" ref="transitionEvaluator" />
        <constructor-arg name="businessDataRepository" ref="businessDataRepository"/>
        <constructor-arg name="refBusinessDataService" ref="refBusinessDataService"/>
	</bean>
	
	<bean id="transactionalProcessInstanceInterruptor" class="org.bonitasoft.engine.execution.TransactionalProcessInstanceInterruptor">
		<constructor-arg name="processInstanceService" ref="processInstanceService" />
		<constructor-arg name="flowNodeInstanceService" ref="activityInstanceService" />
		<constructor-arg name="processExecutor" ref="processExecutor" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>
	
	<bean id="nodeConfiguration" class="org.bonitasoft.engine.api.impl.NodeConfigurationImpl"  autowire="byType">
		<property name="shouldStartScheduler" value="true" />
		<property name="shouldRestartElements" value="true" />
		<property name="shouldStartEventHandlingJob" value="true" />
		
		<property name="jobListeners">
			<list>
				<ref bean="loggerJobListener" />
				<ref bean="jdbcJobListener" />
			</list>
		</property>
	</bean>

    <bean id="jobLogCreator" class="org.bonitasoft.engine.scheduler.impl.JobLogCreator">
        <constructor-arg name="jobService" ref="jobService" />
        <constructor-arg name="logger" ref="platformTechnicalLoggerService"/>
    </bean>

    <bean id="jdbcJobListener" class="org.bonitasoft.engine.scheduler.impl.JDBCJobListener">
		<constructor-arg name="schedulerService" ref="scheduler" />
		<constructor-arg name="schedulerExecutor" ref="schedulerExecutor" />
		<constructor-arg name="jobService" ref="jobService" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="transactionService" ref="transactionService" />
		<constructor-arg name="incidentService" ref="incidentService" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
        <constructor-arg name="jobLogCreator" ref="jobLogCreator"/>
	</bean>

	<bean id="loggerJobListener" class="org.bonitasoft.engine.scheduler.impl.TechnicalLoggerJobListener">
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>
	
	<bean id="dependencyResolver" class="org.bonitasoft.engine.api.impl.resolver.DependencyResolver">
		<constructor-arg name="dependencyResolvers">
			<list>
				<bean class="org.bonitasoft.engine.api.impl.resolver.ActorProcessDependencyResolver" />
				<bean class="org.bonitasoft.engine.api.impl.resolver.ConnectorProcessDependencyResolver" />
				<bean class="org.bonitasoft.engine.api.impl.resolver.UserFilterProcessDependencyResolver" />
                <bean class="org.bonitasoft.engine.api.impl.resolver.ParameterProcessDependencyResolver"/>
			</list>
		</constructor-arg>
	</bean>

</beans>