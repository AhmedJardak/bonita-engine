<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:p="http://www.springframework.org/schema/p"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">

	<bean id="hbmResourcesConfigurationProvider" class="org.bonitasoft.engine.persistence.HibernateResourcesConfigurationProviderImpl">
		<property name="hbmResources">
			<list>
				<ref bean="hbm-bonita-persistence-test" />
				<ref bean="hbm-bonita-archive-test" />
				<ref bean="hbm-bonita-log-model" />
				<ref bean="hbm-bonita-platform-model" />
				<ref bean="hbm-bonita-dependency-model" />
				<ref bean="hbm-bonita-dependency-platform-model" />
				<ref bean="hbm-bonita-identity-model" />
				<ref bean="hbm-bonita-scheduler" />
				<ref bean="hbm-bos-command-model" />
				<ref bean="hbm-bos-data-instance-model" />
				<ref bean="hbm-bos-data-instance-model-arch" />
				<ref bean="hbm-bos-platform-command-model" />
				<ref bean="hbm-bos-profile-model" />
				<ref bean="hbm-bos-theme-model" />
			</list>
		</property>
	</bean>

	<bean id="queriableLoggerStrategy" class="org.bonitasoft.engine.MockQueriableLoggerStrategy" />

	<bean id="queriableLogSessionProvider" class="org.bonitasoft.engine.MockQueriableLogSessionProviderImpl" />

	<bean id="archivingStrategy" class="org.bonitasoft.engine.archive.impl.DefaultArchivingStrategyForTest" />

	<bean id="dbProperties" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
		<property name="locations">
			<array>
				<value>file:${bonita.services.folder}/bonita-platform.properties</value>
				<value>classpath:jdbc-${sysprop.bonita.db.vendor}.properties</value>
			</array>
		</property>
	</bean>

	<bean id="journalConfigurationProvider" class="org.bonitasoft.engine.persistence.HibernateConfigurationProviderImpl">
		<constructor-arg name="properties">
			<props>
				<prop key="hibernate.connection.datasource">${database.journal.datasource.name}</prop>
				<prop key="hibernate.current_session_context_class">jta</prop>
				<prop key="hibernate.transaction.factory_class">org.hibernate.engine.transaction.internal.jta.CMTTransactionFactory</prop>
				<prop key="hibernate.transaction.jta.platform">${hibernate.transaction.jta_platform}</prop>
				<prop key="hibernate.dialect">${hibernate.journal.dialect}</prop>
				<prop key="hibernate.interceptor">${hibernate.journal.interceptor}</prop>
				<prop key="hibernate.show_sql">${hibernate.journal.show_sql}</prop>
				<prop key="hibernate.format_sql">${hibernate.journal.format_sql}</prop>
				<prop key="hibernate.use_sql_comments">${hibernate.journal.use_sql_comments}</prop>
				<prop key="hibernate.generate_statistics">false</prop>
				<prop key="hibernate.connection.shutdown">true</prop>
				<prop key="hibernate.validator.autoregister_listeners">false</prop>
				<prop key="hibernate.validator.apply_to_ddl">false</prop>
				<prop key="javax.persistence.validation.mode">NONE</prop>
			</props>
		</constructor-arg>
		<constructor-arg ref="hbmResourcesConfigurationProvider" />
		<constructor-arg name="interfaceToClassMapping">
			<map>
				<!-- platform -->
				<entry key="org.bonitasoft.engine.platform.model.SPlatform" value="org.bonitasoft.engine.platform.model.impl.SPlatformImpl" />
				<entry key="org.bonitasoft.engine.platform.model.STenant" value="org.bonitasoft.engine.platform.model.impl.STenantImpl" />
				<entry key="org.bonitasoft.engine.platform.command.model.SPlatformCommand" value="org.bonitasoft.engine.platform.command.model.impl.SPlatformCommandImpl" />
				<entry key="org.bonitasoft.engine.dependency.model.SPlatformDependency" value="org.bonitasoft.engine.dependency.model.impl.SPlatformDependencyImpl" />
				<entry key="org.bonitasoft.engine.dependency.model.SPlatformDependencyMapping" value="org.bonitasoft.engine.dependency.model.impl.SPlatformDependencyMappingImpl" />
				<!-- services -->
				<entry key="org.bonitasoft.engine.dependency.model.SDependency" value="org.bonitasoft.engine.dependency.model.impl.SDependencyImpl" />
				<entry key="org.bonitasoft.engine.dependency.model.SDependencyMapping" value="org.bonitasoft.engine.dependency.model.impl.SDependencyMappingImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SUser" value="org.bonitasoft.engine.identity.model.impl.SUserImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SRole" value="org.bonitasoft.engine.identity.model.impl.SRoleImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SGroup" value="org.bonitasoft.engine.identity.model.impl.SGroupImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SUserMembership" value="org.bonitasoft.engine.identity.model.impl.SUserMembershipImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SCustomUserInfoDefinition" value="org.bonitasoft.engine.identity.model.impl.SCustomUserInfoDefinitionImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SCustomUserInfoValue" value="org.bonitasoft.engine.identity.model.impl.SCustomUserInfoValueImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SContactInfo" value="org.bonitasoft.engine.identity.model.impl.SContactInfoImpl" />
				<entry key="org.bonitasoft.engine.identity.model.SUserLogin" value="org.bonitasoft.engine.identity.model.impl.SUserLoginImpl" />
				<entry key="org.bonitasoft.engine.queriablelogger.model.SQueriableLog" value="org.bonitasoft.engine.queriablelogger.model.impl.SQueriableLogImpl" />
				<entry key="org.bonitasoft.engine.queriablelogger.model.SQueriableLogParameter" value="org.bonitasoft.engine.queriablelogger.model.impl.SQueriableLogParameterImpl" />
				<entry key="org.bonitasoft.engine.scheduler.model.SJobDescriptor" value="org.bonitasoft.engine.scheduler.model.impl.SJobDescriptorImpl" />
				<entry key="org.bonitasoft.engine.scheduler.model.SJobParameter" value="org.bonitasoft.engine.scheduler.model.impl.SJobParameterImpl" />
				<entry key="org.bonitasoft.engine.scheduler.model.SJobLog" value="org.bonitasoft.engine.scheduler.model.impl.SJobLogImpl" />
				<entry key="org.bonitasoft.engine.command.model.SCommand" value="org.bonitasoft.engine.command.model.SCommandImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SBooleanDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SBooleanDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SIntegerDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SIntegerDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SDoubleDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SDoubleDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SFloatDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SFloatDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SShortTextDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SShortTextDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SLongDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SLongDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SDateDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SDateDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SLongTextDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SLongTextDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SXMLDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SXMLDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SBlobDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SBlobDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.SXMLObjectDataInstance" value="org.bonitasoft.engine.data.instance.model.impl.SXMLObjectDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.profile.model.SProfile" value="org.bonitasoft.engine.profile.model.impl.SProfileImpl" />
				<entry key="org.bonitasoft.engine.profile.model.SProfileEntry" value="org.bonitasoft.engine.profile.model.impl.SProfileEntryImpl" />
				<entry key="org.bonitasoft.engine.profile.model.SProfileMember" value="org.bonitasoft.engine.profile.model.impl.SProfileMemberImpl" />

				<entry key="org.bonitasoft.engine.data.instance.model.archive.SABooleanDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SABooleanDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SAIntegerDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SAIntegerDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SADoubleDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SADoubleDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SAFloatDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SAFloatDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SAShortTextDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SAShortTextDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SALongDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SALongDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SADateDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SADateDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SALongTextDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SALongTextDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SAXMLDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SAXMLDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SABlobDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SABlobDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SAXMLObjectDataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SAXMLObjectDataInstanceImpl" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SADataInstance" value="org.bonitasoft.engine.data.instance.model.archive.impl.SADataInstanceImpl" />
			</map>
		</constructor-arg>
		<constructor-arg name="mappingExclusions">
			<list />
		</constructor-arg>
	</bean>

	<bean id="parentClassLoaderResolver" class="org.bonitasoft.engine.classloader.DefaultParentClassLoaderResolver"/>

	<bean name="sequenceManager" class="org.bonitasoft.engine.sequence.SequenceManagerImpl">
		<constructor-arg name="lockService" ref="lockService" />
		<constructor-arg name="rangeSizes">
			<map>
				<!-- Most used objects: range size depends on process design -->
				<entry key="30" value="10000" /><!-- queriable log -->
				<entry key="31" value="200000" /><!-- queriable log parameter -->
				<entry key="10020" value="5000" /><!-- data -->
				<entry key="20050" value="25000" /><!-- archived data --><!-- 5 change by data -->

				<!-- less used objects -->
				<entry key="10012" value="100" /><!-- ProcessDefinition -->
				<entry key="20" value="100" /><!-- user -->
				<entry key="21" value="100" /><!-- group -->
				<entry key="22" value="100" /><!-- role -->
				<entry key="23" value="100" /><!-- user_memebership -->
				<entry key="24" value="100" /><!-- P-metadata_def -->
				<entry key="25" value="100" /><!-- P-metadata_val -->
				<entry key="26" value="100" /><!-- user_contactinfo -->
				<entry key="50" value="100" /><!-- dataSource -->
				<entry key="51" value="100" /><!-- dataSourceParameter -->
				<entry key="60" value="100" /><!-- employee -->
				<entry key="61" value="100" /><!-- laptop -->
				<entry key="62" value="100" /><!-- address -->
				<entry key="63" value="100" /><!-- project -->
				<entry key="64" value="100" /><!-- employeeprojectmapping -->
				<entry key="65" value="100" /><!-- saemployee -->
				<entry key="70" value="100" /><!-- jobDescriptor -->
				<entry key="71" value="100" /><!-- jobParameter -->
				<entry key="90" value="100" /><!-- command -->
				<entry key="10070" value="100" /><!-- ExternalIdentityMapping -->
				<entry key="10090" value="100" /><!-- document_content -->
			</map>
		</constructor-arg>
		<constructor-arg name="defaultRangeSize" value="100" />
		<constructor-arg name="sequencesMappings">
			<map>
				<entry key="org.bonitasoft.engine.persistence.model.Human" value="1000" />
				<entry key="org.bonitasoft.engine.persistence.model.Child" value="1000" />
				<entry key="org.bonitasoft.engine.persistence.model.Parent" value="1000" />
				<entry key="org.bonitasoft.engine.persistence.model.Car" value="1001" />
				<entry key="org.bonitasoft.engine.archive.model.Employee" value="60" />
				<entry key="org.bonitasoft.engine.archive.model.Laptop" value="61" />
				<entry key="org.bonitasoft.engine.archive.model.Address" value="62" />
				<entry key="org.bonitasoft.engine.archive.model.Project" value="63" />
				<entry key="org.bonitasoft.engine.archive.model.EmployeeProjectMapping" value="64" />
				<entry key="org.bonitasoft.engine.archive.model.SAEmployee" value="65" />
				<!-- platform -->
				<entry key="org.bonitasoft.engine.platform.model.impl.SPlatformImpl" value="0" />
				<entry key="org.bonitasoft.engine.platform.model.impl.STenantImpl" value="1" />
				<entry key="org.bonitasoft.engine.dependency.model.impl.SPlatformDependencyImpl" value="2" />
				<entry key="org.bonitasoft.engine.dependency.model.impl.SPlatformDependencyMappingImpl" value="3" />
				<entry key="org.bonitasoft.engine.platform.command.model.impl.SPlatformCommandImpl" value="4" />
				<!-- tenant -->
				<entry key="org.bonitasoft.engine.dependency.model.impl.SDependencyImpl" value="10" />
				<entry key="org.bonitasoft.engine.dependency.model.impl.SDependencyMappingImpl" value="11" />
				<entry key="org.bonitasoft.engine.identity.model.impl.SUserImpl" value="20" />
				<entry key="org.bonitasoft.engine.identity.model.impl.SRoleImpl" value="21" />
				<entry key="org.bonitasoft.engine.identity.model.impl.SGroupImpl" value="22" />
				<entry key="org.bonitasoft.engine.identity.model.impl.SUserMembershipImpl" value="23" />
				<entry key="org.bonitasoft.engine.identity.model.impl.SCustomUserInfoDefinitionImpl" value="24" />
				<entry key="org.bonitasoft.engine.identity.model.impl.SCustomUserInfoValueImpl" value="25" />
				<entry key="org.bonitasoft.engine.identity.model.impl.SContactInfoImpl" value="26" />
				<entry key="org.bonitasoft.engine.queriablelogger.model.impl.SQueriableLogImpl" value="30" />
				<entry key="org.bonitasoft.engine.queriablelogger.model.impl.SQueriableLogParameterImpl" value="31" />
				<entry key="org.bonitasoft.engine.scheduler.model.impl.SJobDescriptorImpl" value="70" />
				<entry key="org.bonitasoft.engine.scheduler.model.impl.SJobParameterImpl" value="71" />
				<entry key="org.bonitasoft.engine.scheduler.model.impl.SJobLogImpl" value="72" />
				<entry key="org.bonitasoft.engine.command.model.SCommandImpl" value="90" />
				<entry key="org.bonitasoft.engine.theme.model.impl.SThemeImpl" value="9890" />
				<entry key="org.bonitasoft.engine.profile.model.impl.SProfileImpl" value="9990" />
				<entry key="org.bonitasoft.engine.profile.model.impl.SProfileEntryImpl" value="9991" />
				<entry key="org.bonitasoft.engine.profile.model.impl.SProfileMemberImpl" value="9992" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SBooleanDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SIntegerDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SDoubleDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SFloatDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SShortTextDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SLongDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SDateDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SLongTextDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SXMLDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SBlobDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.data.instance.model.impl.SXMLObjectDataInstanceImpl" value="10020" />
				<entry key="org.bonitasoft.engine.external.identity.mapping.model.impl.SExternalIdentityMappingImpl" value="10070" />
				<entry key="org.bonitasoft.engine.core.document.model.impl.SDocumentMappingImpl" value="10090" />
				<!-- archived objects -->
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SADataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SABooleanDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SAIntegerDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SADoubleDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SAFloatDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SAShortTextDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SALongDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SADateDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SALongTextDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SAXMLDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SABlobDataInstanceImpl" value="20050" />
				<entry key="org.bonitasoft.engine.data.instance.model.archive.impl.SAXMLObjectDataInstanceImpl" value="20050" />
			</map>
		</constructor-arg>
		<constructor-arg name="datasource" ref="bonitaSequenceManagerDSJNDI" />
		<constructor-arg name="retries" value="9" />
		<constructor-arg name="delay" value="10" />
		<constructor-arg name="delayFactor" value="3" />
	</bean>

	<bean id="archiveService" class="org.bonitasoft.engine.archive.impl.ArchiveServiceImpl">
		<constructor-arg name="definitiveArchivePersistenceService" ref="persistenceService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="archivingStrategy" ref="archivingStrategy" />
		<constructor-arg ref="transactionService" />
	</bean>


	<bean id="authenticationService" class="org.bonitasoft.engine.authentication.impl.AuthenticationServiceImpl">
		<constructor-arg name="identityService" ref="identityService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>


	<bean id="cacheConfigurations" class="org.bonitasoft.engine.cache.CacheConfigurations" autowire="byType" />

	<bean id="connectorCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="CONNECTOR" />
	</bean>

	<bean id="processDefCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="_PROCESSDEF" />
	</bean>

	<bean id="userFilterCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="USER_FILTER" />
	</bean>

	<bean id="migrationPlanCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="MIGRATION_PLAN_CACHE_NAME" />
	</bean>

	<bean id="breakpointCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="BREAKPOINTS_BY_INSTANCE" />
	</bean>

	<bean id="groovyScriptCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="GROOVY_SCRIPT_CACHE_NAME" />
		<property name="timeToLiveSeconds" value="3600" />
		<property name="maxElementsInMemory" value="10000" />
		<property name="inMemoryOnly" value="true" />
	</bean>

	<bean id="synchroServiceCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="SYNCHRO_SERVICE_CACHE" />
		<property name="timeToLiveSeconds" value="120" />
		<property name="maxElementsInMemory" value="10000" />
		<property name="inMemoryOnly" value="true" />
	</bean>

	<bean id="transientDataCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="transient_data" />
		<property name="maxElementsInMemory" value="10000" />
		<property name="inMemoryOnly" value="true" />
		<property name="eternal" value="true" />
	</bean>
	
	<bean id="platformCacheConfig" class="org.bonitasoft.engine.cache.CacheConfiguration">
		<property name="name" value="PLATFORM" />
		<property name="maxElementsInMemory" value="100" />
		<property name="inMemoryOnly" value="true" />
		<property name="eternal" value="true" />
	</bean>


    <bean id="cacheService" class="org.bonitasoft.engine.cache.ehcache.EhCacheCacheService" destroy-method="stop">
        <constructor-arg name="logger" ref="platformTechnicalLoggerService" />
        <constructor-arg name="sessionAccessor" ref="sessionAccessor" />
        <constructor-arg name="cacheConfigurations" ref="cacheConfigurations" />
        <constructor-arg name="defaultCacheConfiguration">
            <bean class="org.bonitasoft.engine.cache.CacheConfiguration" />
        </constructor-arg>
        <constructor-arg name="diskStorePath" value="java.io.tmpdir/tenant.test.cache" />
    </bean>

    <bean id="platformCacheService" class="org.bonitasoft.engine.cache.ehcache.PlatformEhCacheCacheService" destroy-method="stop">
        <constructor-arg name="logger" ref="platformTechnicalLoggerService" />
        <constructor-arg name="sessionAccessor" ref="sessionAccessor" />
        <constructor-arg name="cacheConfigurations" ref="cacheConfigurations" />
        <constructor-arg name="defaultCacheConfiguration">
            <bean class="org.bonitasoft.engine.cache.CacheConfiguration" />
        </constructor-arg>
        <constructor-arg name="diskStorePath" value="java.io.tmpdir/platform.test.cache" />
    </bean>


	<bean id="commandService" class="org.bonitasoft.engine.command.api.impl.CommandServiceImpl">
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
	</bean>


	<bean id="hbm-bos-command-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/command/model/impl/hibernate/command.hbm.xml</value>
				<value>org/bonitasoft/engine/command/model/impl/hibernate/command.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.command.model.SCommand" value="command" />
			</map>
		</property>
	</bean>


	<bean id="connectorExecutor" class="org.bonitasoft.engine.connector.impl.ConnectorExecutorImpl">
		<constructor-arg name="queueCapacity" value="10" />
		<constructor-arg name="corePoolSize" value="5" />
		<constructor-arg name="loggerService" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="maximumPoolSize" value="100" />
		<constructor-arg name="keepAliveTimeSeconds" value="100" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="sessionService" ref="sessionService" />
        <constructor-arg name="timeTracker" ref="timeTracker" />
	</bean>



	<bean id="dataInstanceService" class="org.bonitasoft.engine.data.instance.api.impl.DataInstanceServiceImpl">
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="archiveService" ref="archiveService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>

	<bean id="dataExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.DataExpressionExecutorStrategy">
		<constructor-arg name="dataService" ref="dataInstanceService" />
		<constructor-arg name="parentContainerResolver" ref="parentContainerResolver"/>
	</bean>

	<bean id="parentContainerResolver" class="org.bonitasoft.engine.test.util.TestParentContainerResolver"/>

	<bean id="hbm-bos-data-instance-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/data/instance/model/impl/hibernate/data.instance.hbm.xml</value>
				<value>org/bonitasoft/engine/data/instance/model/impl/hibernate/data.instance.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.data.instance.model.SDataInstance" value="dataInstance" />
			</map>
		</property>
	</bean>

	<bean id="hbm-bos-data-instance-model-arch" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/data/instance/model/impl/hibernate/archived.data.instance.hbm.xml</value>
				<value>org/bonitasoft/engine/data/instance/model/impl/hibernate/archived.data.instance.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.data.instance.model.archive.SADataInstance" value="saDataInstance" />
			</map>
		</property>
	</bean>

	<bean id="transientDataService"
		class="org.bonitasoft.engine.core.data.instance.impl.TransientDataServiceImpl">
		<constructor-arg name="cacheService" ref="cacheService" />
	</bean>

	<bean id="transientDataExpressionExecutorStrategy"
		class="org.bonitasoft.engine.core.data.instance.impl.TransientDataExpressionExecutorStrategy">
		<constructor-arg name="transientDataService" ref="transientDataService" />
	</bean>


	<bean id="dependencyService" class="org.bonitasoft.engine.dependency.impl.DependencyServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
    	<constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
    	<constructor-arg name="classLoaderService" ref="classLoaderService" />
	</bean>


	<bean id="hbm-bonita-dependency-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/dependency/model/impl/hibernate/dependency.hbm.xml</value>
				<value>org/bonitasoft/engine/dependency/model/impl/hibernate/dependency.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.dependency.model.SDependency" value="dependency" />
				<entry key="org.bonitasoft.engine.dependency.model.SDependencyMapping" value="dependencymapping" />
			</map>
		</property>
	</bean>


	<bean id="platformDependencyService" class="org.bonitasoft.engine.dependency.impl.PlatformDependencyServiceImpl">
		<constructor-arg name="platformPersistenceService" ref="platformPersistenceService" />
		<constructor-arg name="classLoaderService" ref="classLoaderService" />
	</bean>


	<bean id="hbm-bonita-dependency-platform-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/dependency/model/impl/hibernate/platform-dependency.hbm.xml</value>
				<value>org/bonitasoft/engine/dependency/model/impl/hibernate/platform-dependency.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.dependency.model.SPlatformDependency" value="pdependency" />
				<entry key="org.bonitasoft.engine.dependency.model.SPlatformDependencyMapping" value="pdependencymapping" />
			</map>
		</property>
	</bean>


	<bean id="bonitaDSJNDI" class="org.springframework.jndi.JndiObjectFactoryBean">
		<property name="jndiName" value="${database.journal.datasource.name}" />
	</bean>

	<bean id="bonitaSequenceManagerDSJNDI" class="org.springframework.jndi.JndiObjectFactoryBean">
		<property name="jndiName" value="${database.sequence.manager.datasource.name}" />
	</bean>



	<bean id="eventService" class="org.bonitasoft.engine.events.impl.EventServiceImpl">
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>



	<bean id="expressionService" class="org.bonitasoft.engine.expression.impl.ExpressionServiceImpl">
		<constructor-arg name="expressionExecutorStrategyProvider" ref="expressionExecutorStrategyProvider" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="checkExpressionReturnType" value="true" />
        <constructor-arg name="timeTracker" ref="timeTracker" />
	</bean>

	<bean id="expressionExecutorStrategyProvider" class="org.bonitasoft.engine.expression.ExpressionExecutorStrategyProvider" autowire="byType" />

	<bean id="ConstantExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.impl.ConstantExpressionExecutorStrategy" />

	<bean id="GroovyScriptExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.impl.GroovyScriptExpressionExecutorCacheStrategy">
		<constructor-arg name="cacheService" ref="cacheService" />
		<constructor-arg name="classLoaderService" ref="classLoaderService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>

	<bean id="patternExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.impl.PatternExpressionExecutorStrategy" />

	<bean id="xPathReadExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.impl.XPathReadExpressionExecutorStrategy" />

	<bean id="listExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.impl.ListExpressionExecutorStrategy" />

	<bean id="equalityComparator" class="org.bonitasoft.engine.expression.impl.condition.EqualityComparator" />
	<bean id="inequalityComparator" class="org.bonitasoft.engine.expression.impl.condition.InequalityComparator" />
	<bean id="binaryComparatorMapper" class="org.bonitasoft.engine.expression.impl.condition.BinaryComparatorMapper">
		<constructor-arg name="equalityComparator" ref="equalityComparator"/>
		<constructor-arg name="inequalityComparator" ref="inequalityComparator"/>
	</bean>

	<bean id="binaryComparatorExecutor" class="org.bonitasoft.engine.expression.impl.condition.BinaryComparatorExecutor">
		<constructor-arg name="mapper" ref="binaryComparatorMapper"/>
	</bean>

	<bean id="logicalComplementExecutor" class="org.bonitasoft.engine.expression.impl.condition.LogicalComplementExecutor" />

	<bean id="conditionExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.impl.ConditionExpressionExecutorStrategy" >
		<constructor-arg name="logicalComplementExecutor" ref="logicalComplementExecutor" />
		<constructor-arg name="binaryComparatorExecutor" ref="binaryComparatorExecutor" />
	</bean>

	<bean id="javaMethodCallExpressionExecutorStrategy" class="org.bonitasoft.engine.expression.impl.JavaMethodCallExpressionExecutorStrategy" />



	<bean id="hbm-bos-external-identity-mapping" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/external/identity/mapping/model/impl/hibernate/external.identity.mapping.hbm.xml</value>
				<value>org/bonitasoft/engine/external/identity/mapping/model/impl/hibernate/external.identity.mapping.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.external.identity.mapping.model.SExternalIdentityMapping" value="ext_ident_mapping" />
			</map>
		</property>
	</bean>


	<bean id="externalIdentityMappingService" class="org.bonitasoft.engine.external.identity.mapping.impl.ExternalIdentityMappingServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
	</bean>


	<bean id="identityService" class="org.bonitasoft.engine.identity.impl.IdentityServiceImpl">
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
        <constructor-arg name="encrypter">
        	<bean class="org.bonitasoft.engine.identity.impl.MD5CredentialsEncrypter" />
        </constructor-arg>
	</bean>


	<bean id="hbm-bonita-identity-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/identity/model/impl/hibernate/identity.hbm.xml</value>
				<value>org/bonitasoft/engine/identity/model/impl/hibernate/identity.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.identity.model.SUser" value="user" />
				<entry key="org.bonitasoft.engine.identity.model.SRole" value="role" />
				<entry key="org.bonitasoft.engine.identity.model.SGroup" value="group_" />
				<entry key="org.bonitasoft.engine.identity.model.SCustomUserInfoDefinition" value="custom_usr_inf_def" />
				<entry key="org.bonitasoft.engine.identity.model.SCustomUserInfoValue" value="custom_usr_inf_val" />
				<entry key="org.bonitasoft.engine.identity.model.SUserMembership" value="user_membership" />
				<entry key="org.bonitasoft.engine.identity.model.SContactInfo" value="contactinfo" />
			</map>
		</property>
	</bean>


	<bean id="incidentService" class="org.bonitasoft.engine.incident.IncidentServiceImpl">
		<constructor-arg name="handlers">
			<list>
				<bean class="org.bonitasoft.engine.incident.FileLoggerIncidentHandler">
					<constructor-arg name="logFilePath" value="target" />
				</bean>
			</list>
		</constructor-arg>
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>


	<bean id="lockService" class="org.bonitasoft.engine.lock.impl.MemoryLockService" scope="singleton">
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
		<constructor-arg name="lockTimeout" value="60" />
		<constructor-arg name="lockPoolSize" value="100" />
	</bean>


	<bean id="syncQueriableLoggerService" class="org.bonitasoft.engine.services.impl.SyncQueriableLoggerServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="loggerStrategy" ref="queriableLoggerStrategy" />
		<constructor-arg name="sessionProvider" ref="queriableLogSessionProvider" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
		<constructor-arg name="platformService" ref="platformService" />
	</bean>


	<bean id="hbm-bonita-log-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/queriablelogger/model/impl/hibernate/queriablelogger.hbm.xml</value>
				<value>org/bonitasoft/engine/queriablelogger/model/impl/hibernate/queriablelogger.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.queriablelogger.model.SQueriableLog" value="log" />
			</map>
		</property>
	</bean>


	<bean id="platformTechnicalLoggerService" class="org.bonitasoft.engine.log.technical.TechnicalLoggerSLF4JImpl" />
	
	<bean id="tenantTechnicalLoggerService" class="org.bonitasoft.engine.log.technical.TechnicalLoggerSLF4JImpl" >
		<constructor-arg name="tenantId" value="111" />
	</bean>

	<bean id="persistenceService" class="org.bonitasoft.engine.persistence.TenantHibernatePersistenceService" depends-on="dbProperties">
		<constructor-arg name="name" value="journal" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="hbmConfigurationProvider" ref="journalConfigurationProvider" />
		<constructor-arg name="extraHibernateProperties"><null /></constructor-arg>
		<constructor-arg name="likeEscapeCharacter" value="#" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
		<constructor-arg name="sequenceManager" ref="sequenceManager" />
		<constructor-arg name="datasource" ref="bonitaSequenceManagerDSJNDI" />
		<constructor-arg name="enableWordSearch" value="false" />
		<constructor-arg name="wordSearchExclusionMappings">
			<set>
				<!-- value>org.bonitasoft.engine.identity.model.SUser</value -->
			</set>
		</constructor-arg>
	</bean>

	<bean id="platformPersistenceService" class="org.bonitasoft.engine.persistence.PlatformHibernatePersistenceService" depends-on="dbProperties">
		<constructor-arg name="name" value="platform" />
		<constructor-arg name="hbmConfigurationProvider" ref="journalConfigurationProvider" />
        <constructor-arg name="extraHibernateProperties"><null /></constructor-arg>
		<constructor-arg name="likeEscapeCharacter" value="#" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
		<constructor-arg name="sequenceManager" ref="sequenceManager" />
		<constructor-arg name="datasource" ref="bonitaSequenceManagerDSJNDI" />
        <constructor-arg name="enableWordSearch" value="false" />
        <constructor-arg name="wordSearchExclusionMappings">
            <set>
                <!-- value>org.bonitasoft.engine.identity.model.SUser</value -->
            </set>
        </constructor-arg>
	</bean>

	<bean id="platformService" class="org.bonitasoft.engine.platform.impl.PlatformServiceImpl">
		<constructor-arg ref="platformPersistenceService" />
		<constructor-arg name="tenantPersistenceServices">
			<list>
				<ref bean="persistenceService" />
			</list>
		</constructor-arg>
		<constructor-arg ref="platformTechnicalLoggerService" />
		<constructor-arg ref="platformCacheService" />
		<constructor-arg ref="platformProperties" />
		<constructor-arg name="recorder" ref="platformRecorderSync" />
		<constructor-arg name="datasource" ref="bonitaSequenceManagerDSJNDI" />
		<constructor-arg name="sqlFolders">
			<list>
                <value>/sql/${db.vendor}</value>
                <value>target/test-classes/sql-test/sql/${db.vendor}</value>
			</list>
        </constructor-arg>
        <constructor-arg name="statementDelimiter" value="${sql.delimiter}" />
	</bean>
	

	<bean id="platformAuthenticationService" class="org.bonitasoft.engine.platform.authentication.impl.PlatformAuthenticationServiceImpl" >
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>


	<bean id="platformCommandService" class="org.bonitasoft.engine.platform.command.impl.PlatformCommandServiceImpl">
		<constructor-arg name="platformPersistenceService" ref="platformPersistenceService" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>
	

	<bean id="hbm-bos-platform-command-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/platform/command/model/impl/hibernate/platformCommand.hbm.xml</value>
				<value>org/bonitasoft/engine/platform/command/model/impl/hibernate/platformCommand.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.platform.command.model.SPlatformCommand" value="platformCommand" />
			</map>
		</property>
	</bean>


	<bean id="hbm-bonita-platform-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/platform/model/impl/hibernate/platform.hbm.xml</value>
				<value>org/bonitasoft/engine/platform/model/impl/hibernate/platform.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.platform.model.SPlatform" value="platform" />
				<entry key="org.bonitasoft.engine.platform.model.STenant" value="tenant" />
			</map>
		</property>
	</bean>


	<bean id="platformProperties" class="org.bonitasoft.engine.platform.model.impl.SPlatformPropertiesImpl" />


	<bean id="platformSessionService" class="org.bonitasoft.engine.platform.session.impl.PlatformSessionServiceImpl">
		<constructor-arg name="platformSessionProvider" ref="platformSessionProvider" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>



	<bean id="platformSessionProvider" class="org.bonitasoft.engine.platform.session.impl.PlatformSessionProviderImpl">
	</bean>


	<bean id="profileService" class="org.bonitasoft.engine.profile.impl.ProfileServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
        <constructor-arg name="sessionAccessor" ref="sessionAccessor" />
        <constructor-arg name="sessionService" ref="sessionService" />
	</bean>


	<bean id="hbm-bos-profile-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/profile/model/impl/hibernate/profile.hbm.xml</value>
				<value>org/bonitasoft/engine/profile/model/impl/hibernate/profile.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.profile.model.SProfile" value="profile" />
				<entry key="org.bonitasoft.engine.profile.model.SProfileEntry" value="profileentry" />
				<entry key="org.bonitasoft.engine.profile.model.SProfileMember" value="pm" />
			</map>
		</property>
	</bean>


	<bean id="hbm-bonita-scheduler" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/scheduler/impl/hibernate/schedulerimpl.hbm.xml</value>
				<value>org/bonitasoft/engine/scheduler/impl/hibernate/schedulerimpl.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.scheduler.model.SJobDescriptor" value="jd" />
				<entry key="org.bonitasoft.engine.scheduler.model.SJobParameter" value="jp" />
				<entry key="org.bonitasoft.engine.scheduler.model.SJobLog" value="jl" />
			</map>
		</property>
	</bean>


	<bean id="quartzSchedulerFactory" class="org.bonitasoft.engine.scheduler.impl.BonitaSchedulerFactory">
		<constructor-arg name="props">
			<props>
				<prop key="org.quartz.scheduler.skipUpdateCheck">${org.quartz.scheduler.skipUpdateCheck:true}</prop>
				<prop key="org.quartz.threadPool.class">org.quartz.simpl.SimpleThreadPool</prop>
				<prop key="org.quartz.threadPool.threadCount">5</prop>
				<prop key="org.quartz.jobStore.class">org.quartz.impl.jdbcjobstore.JobStoreCMT</prop>
				<prop key="org.quartz.jobStore.driverDelegateClass">${quartz.connection.jobstoredriver:org.quartz.impl.jdbcjobstore.StdJDBCDelegate}</prop>
				<prop key="org.quartz.jobStore.dataSource">managedDS</prop>
				<prop key="org.quartz.jobStore.useProperties">true</prop>
				<prop key="org.quartz.jobStore.nonManagedTXDataSource">notManagedDS</prop>

				<prop key="org.quartz.dataSource.managedDS.jndiURL">${database.journal.datasource.name}</prop>
				<prop key="org.quartz.dataSource.notManagedDS.jndiURL">${database.sequence.manager.datasource.name}</prop>
				<prop key="org.quartz.jobStore.dontSetAutoCommitFalse">true</prop>
				<prop key="org.quartz.scheduler.wrapJobExecutionInUserTransaction">true</prop>
				<prop key="org.quartz.scheduler.userTransactionURL">${userTransaction}</prop>
				<prop key="org.quartz.jobStore.misfireThreshold">2000</prop>
			</props>
		</constructor-arg>
        <constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>

	<bean id="schedulerExecutor" class="org.bonitasoft.engine.scheduler.impl.QuartzSchedulerExecutor">
		<constructor-arg name="schedulerFactory" ref="quartzSchedulerFactory" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="transactionService" ref="transactionService" />
		<constructor-arg name="useOptimization" value="true" />
	</bean>

	<bean id="jobService" class="org.bonitasoft.engine.scheduler.impl.JobServiceImpl">
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="readPersistenceService" ref="persistenceService" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>

	<bean id="scheduler" class="org.bonitasoft.engine.scheduler.impl.SchedulerServiceImpl">
		<constructor-arg name="schedulerExecutor" ref="schedulerExecutor" />
		<constructor-arg name="jobService" ref="jobService" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="transactionService" ref="transactionService" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="servicesResolver" >
			<bean class="org.bonitasoft.engine.test.util.TestsServicesResolver" />
		</constructor-arg>
	</bean>





	<bean id="sessionService" class="org.bonitasoft.engine.session.impl.SessionServiceImpl">
		<constructor-arg name="sessionProvider" ref="sessionProvider" />
		<constructor-arg name="applicationName" value="BPM" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>



	<bean id="sessionProvider" class="org.bonitasoft.engine.session.impl.SessionProviderImpl" />


	<bean id="themeService" class="org.bonitasoft.engine.theme.impl.ThemeServiceImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="recorder" ref="tenantRecorderSync" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
        <constructor-arg name="queriableLoggerService" ref="syncQueriableLoggerService" />
	</bean>


	<bean id="hbm-bos-theme-model" class="org.bonitasoft.engine.persistence.HibernateResourcesProvider">
		<property name="resources">
			<set>
				<value>org/bonitasoft/engine/theme/model/impl/hibernate/theme.hbm.xml</value>
				<value>org/bonitasoft/engine/theme/model/impl/hibernate/theme.queries.hbm.xml</value>
			</set>
		</property>
		<property name="classAliasMappings">
			<map>
				<entry key="org.bonitasoft.engine.theme.model.STheme" value="theme" />
			</map>
		</property>
	</bean>


    <bean id="timeTracker" class="org.bonitasoft.engine.tracking.TimeTracker">
        <constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
        <constructor-arg name="startFlushThread" value="false" />
        <constructor-arg name="flushEventListeners">
            <list>
<!--                 <ref bean="csvFlushEventListener" /> -->
            </list>
        </constructor-arg>
        <constructor-arg name="maxSize" value="1000000" />
        <constructor-arg name="flushIntervalInSeconds"
            value="10" />
        <constructor-arg name="activatedRecords">
            <list>
<!--                 <value>EXECUTE_CONNECTOR_INCLUDING_POOL_SUBMIT</value> -->
<!--                 <value>EXECUTE_CONNECTOR_CALLABLE</value> -->
<!--                 <value>EXECUTE_CONNECTOR_OUTPUT_OPERATIONS</value> -->
<!--                 <value>EXECUTE_CONNECTOR_INPUT_EXPRESSIONS</value> -->
<!--                 <value>EXECUTE_CONNECTOR_DISCONNECT</value> -->
<!--                 <value>EXECUTE_CONNECTOR_WORK</value> -->
<!--                 <value>EVALUATE_EXPRESSION_INCLUDING_CONTEXT</value> -->
<!--                 <value>EVALUATE_EXPRESSION</value> -->
<!--                 <value>EVALUATE_EXPRESSIONS</value> -->
            </list>
        </constructor-arg>
    </bean>

<!--     <bean id="csvFlushEventListener" -->
<!--         class="org.bonitasoft.engine.tracking.csv.CSVFlushEventListener"> -->
<!--         <constructor-arg name="logger" ref="tenantTechnicalLoggerService" /> -->
<!--         <constructor-arg name="outputFolder" value="/tmp" /> -->
<!--         <constructor-arg name="csvSeparator" value=";" /> -->
<!--     </bean> -->
    

	<bean id="transactionManager" class="org.springframework.jndi.JndiObjectFactoryBean">
		<property name="jndiName" value="${transaction.manager}" />
	</bean>

	<bean id="transactionService" class="org.bonitasoft.engine.transaction.JTATransactionServiceImpl">
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
		<constructor-arg name="txManager" ref="transactionManager" />
	</bean>

	<bean id="workService" class="org.bonitasoft.engine.work.ExecutorWorkService">
		<constructor-arg name="transactionService" ref="transactionService" />
		<constructor-arg name="workSynchronizationFactory">
			<bean class="org.bonitasoft.engine.work.SequenceWorkSynchronizationFactory" />
		</constructor-arg>
		<constructor-arg name="loggerService" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="sessionAccessor" ref="sessionAccessor" />
		<constructor-arg name="bonitaExecutorServiceFactory" ref="bonitaExecutorServiceFactory" />
		<constructor-arg name="workTerminationTimeout" value="30" />
	</bean>

	<bean id="bonitaExecutorServiceFactory" class="org.bonitasoft.engine.work.DefaultBonitaExecutorServiceFactory">
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
		<constructor-arg name="tenantId" value="111"  />
		<constructor-arg name="corePoolSize" value="25" />
		<constructor-arg name="maximumPoolSize" value="25" />
		<constructor-arg name="keepAliveTimeSeconds" value="60" />
		<constructor-arg name="queueCapacity" value="10000" />
	</bean>




	<bean id="platformRecorderSync" class="org.bonitasoft.engine.recorder.impl.RecorderImpl">
		<constructor-arg name="persistenceService" ref="platformPersistenceService" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>

	<bean id="tenantRecorderSync" class="org.bonitasoft.engine.recorder.impl.RecorderImpl">
		<constructor-arg name="persistenceService" ref="persistenceService" />
		<constructor-arg name="eventService" ref="eventService" />
		<constructor-arg name="logger" ref="tenantTechnicalLoggerService" />
	</bean>

	<bean id="xmlValidator" class="org.bonitasoft.engine.xml.SAXValidator" />

	<bean id="xmlParser" class="org.bonitasoft.engine.xml.parse.SAXParser">
		<constructor-arg name="validator" ref="xmlValidator" />
		<constructor-arg name="logger">
			<null />
		</constructor-arg>
	</bean>

    <bean id="classLoaderService" class="org.bonitasoft.engine.classloader.ClassLoaderServiceImpl">
        <constructor-arg name="parentClassLoaderResolver" ref="parentClassLoaderResolver" />
        <constructor-arg name="temporaryFolder" value="${java.io.tmpdir}" />
		<constructor-arg name="logger" ref="platformTechnicalLoggerService" />
	</bean>

	<bean id="sessionAccessor" class="org.bonitasoft.engine.sessionaccessor.ThreadLocalSessionAccessor" />

</beans>